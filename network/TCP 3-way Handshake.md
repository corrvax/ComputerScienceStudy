<div align="center">
  <br />
  <h1> TCP 3-way Handshake</h1>
  <br />
</div>

## λ©μ°¨

1. [**TCP 3-way Handshake μ •μμ™€ μ—­ν• **](#1)
2. [**TCP 3-way Handshake κ³Όμ •**](#2)
3. [**TCP 4-way Handshake κ³Όμ •**](#3)

<br />

<div id="1"></div>

## TCP 3-way Handshake μ μ •μμ™€ μ—­ν• 

**μ •μ**<br /><br />
TCP/IP ν”„λ΅ν† μ½μ„ μ΄μ©ν•΄μ„ ν†µμ‹ μ„ ν•λ” μ‘μ©ν”„λ΅κ·Έλ¨μ΄ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•κΈ° μ „μ— λ¨Όμ € **μ •ν™•ν• μ „μ†΅μ„ λ³΄μ¥ν•κΈ° μ„ν•΄** μƒλ€λ°© μ»΄ν“¨ν„°μ™€ μ‚¬μ „μ— μ„Έμ…μ„ μλ¦½ν•λ” κ³Όμ •μ„ μλ―Έν•λ‹¤. 
<br/><br />
**μ—­ν• **
1. μ–‘μ½ λ¨λ‘ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•  μ¤€λΉ„κ°€ λμ—λ‹¤λ” κ²ƒμ„ λ³΄μ¥ν•κ³ , μ‹¤μ λ΅ μ „λ‹¬μ΄ μ‹μ‘λκΈ° μ „μ— ν•μ½μ΄ λ‹¤λ¥Έ μ½μ΄ μ¤€λΉ„λμ—λ‹¤λ” κ²ƒμ„ μ•μ μλ„λ΅ ν•λ‹¤. 
2. μ–‘μ½ λ¨λ‘ μƒλ€νΈμ— λ€ν• μ΄κΈ° μμ°¨ μΌλ ¨λ²νΈλ¥Ό μ–»μ„ μ μλ„λ΅ ν•λ‹¤.
<br />

<div id="2"></div>

## TCP 3-way Handshake κ³Όμ •


![enter image description here](https://t1.daumcdn.net/cfile/tistory/99FB2A3D5B32ED7B0B)

(SYN μ€ synchronize sequence numbers ACKλ” acknowledgements μ μ•½μ)

1. ν΄λΌμ΄μ–ΈνΈ(A)λ” μ„λ²„(B)μ— μ ‘μ†μ„ μ”μ²­ν•λ” SYN ν¨ν‚·μ„ λ³΄λ‚Έλ‹¤. μ΄λ• ν΄λΌμ΄μ–ΈνΈ(A)λ” SYNμ„ λ³΄λ‚΄κ³  SYN/ACK μ‘λ‹µμ„ κΈ°λ‹¤λ¦¬λ” SYN_SENT μƒνƒκ°€ λλ‹¤.
2. μ΄λ• μ„λ²„(B)λ” Listen μƒνƒλ΅ ν¬νΈ μ„λΉ„μ¤κ°€ κ°€λ¥ν• μƒνƒμ—¬μ•Ό ν•λ‹¤. (Closed :λ‹«νμƒνƒ) μ„λ²„(B)λ” SYN μ”μ²­μ„ λ°›κ³  ν΄λΌμ΄μ–ΈνΈ(A)μ—κ² μ”μ²­μ„ μλ½ν•λ‹¤λ” ACKμ™€ SYN flagκ°€ μ„¤μ •λ ν¨ν‚·μ„ λ°μ†΅ν•κ³  ν΄λΌμ΄μ–ΈνΈ(A)κ°€ λ‹¤μ‹ ACKμΌλ΅ μ‘λ‹µν•κΈ°λ¥Ό κΈ°λ‹¤λ¦°λ‹¤. μ΄λ• μ„λ²„(B)λ” SYN_RECEIVED μƒνƒκ°€ λλ‹¤.
3. ν΄λΌμ΄μ–ΈνΈ(A)λ” μ„λ²„(B)μ—κ² ACKμ„ λ³΄λ‚΄κ³  μ΄ν›„λ΅λ¶€ν„°λ” μ—°κ²°μ΄ μ΄λ£¨μ–΄μ§€κ³  λ°μ΄ν„°κ°€ μ¤κ°€κ² λλ‹¤. μ΄λ•μ μ„λ²„(B) μƒνƒκ°€ μ„±λ¦½(ESTABLISHED) μ΄λ‹¤.

μ„μ™€ κ°™μ€ λ°©μ‹μΌλ΅ ν†µμ‹ ν•λ”κ²ƒμ΄ μ‹ λΆ°μ„± μλ” μ—°κ²°μ„ λ§Ίμ–΄ μ¤€λ‹¤λ” TCPμ 3 Way handshake λ°©μ‹μ΄λ‹¤.

 
| μƒνƒ | μ„¤λ… |
|--|--|
| Closed  | λ‹«ν μƒνƒ  |
| Listen  | ν¬νΈκ°€ μ—΄λ¦° μƒνƒλ΅ μ—°κ²° μ”μ²­ λ€κΈ°μ¤‘μΈ μƒνƒ  |
| SYN-send| SYN μ”μ²­μ„ ν• μƒνƒ  |
| SYN-Received  | SYN μ”μ²­μ„ λ°›κ³  μƒλ€λ°©μ μ‘λ‹µμ„ κΈ°λ‹¤λ¦¬λ” μƒνƒ  |
| ESTABLISHED | μ—°κ²°μ΄ ν™•μΈλ μƒνƒ  |


<br />

<div id="3"></div>

## TCP 4-way Handshaking κ³Όμ •
**μ •μ** <br /><br />
μ„Έμ…μ„ μΆ…λ£ν•κΈ° μ„ν•΄ μν–‰λλ” κ³Όμ • 

![enter image description here](https://t1.daumcdn.net/cfile/tistory/2152353F52F1C02835)

1. ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²°μ„ μΆ…λ£ν•κ² λ‹¤λ” FINν”λκ·Έλ¥Ό μ „μ†΅ν•λ‹¤.
2. μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ μ”μ²­(FIN)μ„ λ°›κ³  ν™•μΈλ©”μ‹μ§€(ACK)λ¥Ό λ³΄λ‚΄κ³  μμ‹ μ ν†µμ‹ μ΄ λλ‚ λ•κΉμ§€ κΈ°λ‹¤λ¦¬λ”λ° μ΄ μƒνƒκ°€ **TIME_WAIT**μƒνƒλ‹¤.  
3. λ°μ΄ν„°λ¥Ό λ¨λ‘ λ³΄λ‚΄κ³  ν†µμ‹ μ΄ λλ‚¬μΌλ©΄ μ„λ²„λ” μ—°κ²°μ΄ μΆ…λ£λμ—λ‹¤κ³  ν΄λΌμ΄μ–ΈνΈμ—κ² FINν”λκ·Έλ¥Ό μ „μ†΅ν•λ‹¤ .
4. ν΄λΌμ΄μ–ΈνΈλ” FIN λ©”μ„Έμ§€λ¥Ό ν™•μΈν–λ‹¤λ” λ©”μ„Έμ§€(ACK)λ¥Ό λ³΄λ‚Έλ‹¤.
5. ν΄λΌμ΄μ–ΈνΈμ ACK λ©”μ„Έμ§€λ¥Ό λ°›γ„·μ€ μ„λ²„λ” μ†μΌ“ μ—°κ²°μ„ Close ν•λ‹¤. 
<br />

**π’΅ TIME_WAIT μ΄λ€?**<br />
<br />
μ„λ²„κ°€ FINμ„ μ „μ†΅ν•κΈ° μ „μ— μ „μ†΅ν• ACK ν¨ν‚·μ΄ Routing μ§€μ—°μ΄λ‚ ν¨ν‚· μ μ‹¤λ΅ μΈν• μ¬μ „μ†΅μΌλ΅ FIN ν¨ν‚·λ³΄λ‹¤ λ¦κ² λ„μ°© ν•  μ μλ‹¤. μ΄ κ²½μ° **λ°μ΄ν„°κ°€ μ μ‹¤**λκΈ° λ•λ¬Έμ— μ΄λ¥Ό **λ€λΉ„**ν•μ—¬ ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„λ΅λ¶€ν„° FINμ„ μμ‹ ν•λ”λΌλ„ **μΌμ •μ‹κ°„ (λ””ν΄νΈ 240μ΄) λ™μ• μ„Έμ…μ„ λ‚¨κ²¨ λ†“κ³  μ‰μ—¬ ν¨ν‚·μ„ κΈ°λ‹¤λ¦¬λ” κ³Όμ •**μ„ λ§ν•λ‹¤.  
  
  
